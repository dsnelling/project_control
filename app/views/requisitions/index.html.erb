<h1>Listing requisitions</h1>
<div class="requisition-filter">
  <% form_tag(requisitions_path, :method => :get) do %>
    <%= select_tag :req_filter, 
	    options_for_select (Requisition::REQ_TYPES,session[:req_filter]),
		:onchange => 'this.form.submit()' %>
    <%= submit_tag "Filter" %>
  <% end %>
</div>
<div class="requisition-filter">
  <% form_tag(requisitions_path, :method => :get) do %>
    <%= select_tag :scope_filter, 
	    options_for_select (Requisition::SCOPE_TYPES,session[:scope_filter]),
		:onchange => 'this.form.submit()' %>
    <%= submit_tag "Filter" %>
  <% end %>
</div>
<div class="requisition-filter">
  <% form_tag(requisitions_path, :method => :get) do %>
    <%= select_tag :status_filter, 
	    options_for_select (Requisition::STATUS_TYPES,session[:status_filter]),
		:onchange => 'this.form.submit()' %>
    <%= submit_tag "Filter" %>
  <% end %>
</div>
<div id="requisition-table">
<p>"R-O-S": Required on Site date; "R-PO": Required date of Purchase Contract</p> 
<table class="item_table">
  <tr class="list-header">
    <th class="list-cell">Req num</th>
    <th class="list-cell">Commodity</th>
    <th class="list-cell">Scope</th>
    <th class="list-cell">Status</th>
    <th class="list-cell">MR doc</th>
    <th class="list-cell">R-O-S<br />R-PO</th>
	<th class="list-cell">Bid Applic<br />Approved</th>
    <th class="list-cell">Enquiry issued</th>
    <th class="list-cell">TBT issued<br />
         CBT issued</th>
	<th class="list-cell-vert">PO?</th>
	<th class="list-cell-vert">Com?</th>
    <th  class="list-cell" colspan="3">Action</th>
  </tr>

<% @requisitions.each do |requisition| %>
  <tr class="<%= cycle('list-line-odd', 'list-line-even') %>" >
    <td class="list-cell"><%=h requisition.req_num %></td>
    <td class="list-cell">
	    <%=h truncate(requisition.commodity, :length => 50) %></td>
    <td class="list-cell">
	    <%=h requisition.scope %></td>
    <td class="list-cell"><%=h requisition.status %></td>
    <td class="list-cell"><%=h requisition.mr_doc %></td>
    <td class="list-cell"><%=h requisition.required_on_site %><br />
	  <%=h requisition.required_contract %></td>
    <td class="list-cell"><%=h requisition.bid_applic_approved %></td>
    <td class="list-cell"><%=h requisition.enquiry_issued %></td>
    <td class="list-cell"><%=h requisition.tbt_issued %><br/>
        <%=h requisition.cbt_issued %></td>
    <td class="list-cell"><%= requisition.contracts.empty? ? "&nbsp;" : "Y" %>
	  </td>
	<td class="list-cell"><%= requisition.req_comments.empty? ? "&nbsp;": "Y" %>
	  </td>
    <td class="list-cell"><%= link_to 'Show', requisition %></td>
    <td class="list-cell"><%= link_to 'Edit',
	    edit_requisition_path(requisition) %></td>
    <td><%= link_to 'Destroy', requisition, :confirm => 'Are you sure?',
	    :method => :delete %></td>
  </tr>
<% end %>
</table>
</div>
<br />
<%= will_paginate @requisitions %>

<%= link_to 'New requisition', new_requisition_path %>
